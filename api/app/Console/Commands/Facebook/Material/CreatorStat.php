<?php

namespace App\Console\Commands\Facebook\Material;

use App\Helper\Tool;
use App\Models\Facebook\FacebookAdAccount;
use App\Models\Material\MaterialHashId;
use App\Models\Material\OriginalMaterialData;
use App\Services\Facebook\InsightsService;
use Illuminate\Console\Command;

class CreatorStat extends Command
{
    protected $signature = 'CreatorStat {start?} {end?}';

    protected $description = '统计素材编辑素材的消耗';


    public function handle()
    {
        // 获取活跃广告ID
        $args = $this->arguments();
        $start = $args['start'] ?? '20220201';
        $end = $args['end'] ?? '20220228';
        dump('静态素材采集日期：' . $start . "-" . $end);


        $dy = ["23849086530610422", "23849086549400422", "23849095498900422", "23849095521640422", "23849095628280422", "23849125283880422", "23849133749200422", "23849133764840422", "23849139635330422", "23849139653320422", "23849139670640422", "23849147526260422", "23849160176140422", "23849178945460422", "23849179851020422", "23849282475540144", "23849292983380144", "23849292983390144", "23849292983400144", "23849303470740159", "23849311776340121", "23849330583110121", "23849335464080159", "23849341627920159", "23849347957080159", "23849357452280178", "23849359985790121", "23849370399580159", "23849370421910159", "23849371202020159", "23849372202230121", "23849379026240121", "23849386118870121", "23849406740960450", "23849408774480121", "23849408787600121", "23849419127620178", "23849419200530178", "23849423202660450", "23849423233560450", "23849434351420450", "23849447492020677", "23849458332650450", "23849466359060144", "23849481761590179", "23849549012780120", "23849577170360120", "23849621046000763", "23849637632340763", "23849692855250720", "23849739986750720", "23849740017930720", "23849740030290720", "23849750324090134", "23849750397980134", "23849785804480134", "23849785822810134", "23849785866780134", "23849786648080134", "23849805667730561", "23849805746790561", "23849805759170561", "23849869539550185", "23850055406190603", "23850129781870397", "23850151610710585",];

        // $dy = ["23849086530610422", "23849086549400422"];
        // $fbTimeRange = InsightsService::getIns()->fmtLifeTime(
        //     ['since' => $start, 'until' => $end],
        //     true
        // );
        // $dynamicInfo = InsightsService::getIns()->getBreakdownInsights(
        //     $dy,
        //     '',
        //     'c5',
        //     '',
        //     $fbTimeRange,
        //     '',
        //     '',
        //     ["media_asset"],
        //     '',
        //     true,
        //     true
        // );
        //
        // if (Tool::get($dynamicInfo, 'error')) {
        //     dump('访问失败');
        // }
        // $list = [];
        // foreach ($dynamicInfo as $row) {
        //     foreach ($row as $one) {
        //         if (!Tool::get($list, $one['name'])) {
        //             $list[$one['name']] = 0;
        //         }
        //         $list[$one['name']] += $one['c5'];
        //     }
        // }
        //
        // echo json_encode($list) . PHP_EOL;

        // $c5Insight = '{"1245005946028386":17.32,"348176953687120":17.23,"477676443931245":37.82,"497239455257732":338.64,"3132391190339243":46.51,"693392408755127":37.8,"469126704817447":37.23,"644972063421514":251.07,"494416398759549":36.49,"980298399530843":10.32,"3312729852348487":92.28,"472538071029191":73.2,"332209432177813":47.75,"311445037635554":23.04,"1562133620828383":271.55379100000005,"341761541085235":264.356956,"1347762798987932":74.039253,"624096925323848":67.5,"1551735218516444":664.631493,"2778643609094993":5.888507,"645175270090670":122.51,"265517945729146":253.88,"260231029614879":97.21,"529856655059258":241.5,"486939213003837":315.33,"504115634409014":33.27,"394586589086151":9.15,"292395022993650":400.44,"1019337265629505":25.91,"3092751117654975":47.13,"2753966611571096":27.65,"770956977198301":83.37,"4844691228955592":25,"1056730524884174":96.5,"687645312366722":45.23,"282088190709072":25.82,"4914099008655444":25.03,"957239988292808":37.79,"731432671573830":534.07,"664917091600717":228.02,"458999899291494":29.97,"299159688896658":188.75,"250310240513818":39.52,"2123688844451286":1.7,"317534910398364":2.48,"685205569588266":7.45,"2710798732397506":0.76,"485771659727805":22.06,"444005010802182":19.19,"622650752135679":11.6,"274221611520726":58.16,"658500575368506":49.85,"1005734293687368":51.24,"487887846041683":21.91,"952531325654462":22.27,"3254798041466847":5.13,"456093566161308":1.68,"496181715183029":7.96,"1607600499590563":1.1,"260245329597838":0.25,"2027877047380300":4.84,"526974358737705":2.96,"1040999279830936":0.58,"478530530372875":43.27,"671658947181913":0.82,"224539429884839":0.81,"1127953994675689":0.31,"256177843285726":0.26,"322830633179108":6.58,"458117859226771":0.36,"664563431370895":0.2,"349181580061915":0.01,"323937169590387":0.03,"962112864419472":38.002481,"298815185581952":37.56875,"727098594920715":15.433813,"464064908733208":23.258162000000002,"735614637343657":16.222738,"926073338076002":8.034056,"627792374995523":23.69,"1096823577527831":61.93,"488528526007625":26.17,"5109535725769130":30.78,"323041603202121":24,"1073842513472432":27.53,"480106710436251":37.26,"1132054034215747":37.54,"257647009881674":37.97,"966277611438906":558.791444,"960348928238904":10.470027,"798690458198520":187.280484,"1782506865274829":262.730679,"1546561502391397":0.12,"1531770533876009":15.65004,"477748467143458":0.04,"1243359422740032":0,"650369019340420":0.04,"299802495533157":32.260082999999995,"984319699108503":284.000734,"512227273555536":0.670002,"252957516909086":478.28123600000004,"305943251492105":182.12047099999998,"484401389963978":16.200042,"280234050740264":627.221621,"695875568457942":20.450053,"3053309881552806":20.500053,"2382202318583857":24.950064,"676981423322475":93.660242,"478859737164798":147.760382,"550115306001912":286.620741,"1068783177313253":619.551601,"4955055417921897":166.802738,"363071138754626":5.759059,"674653843893921":3.719392,"306942041420095":0.629897,"340938197915028":0.019997,"1009340489789775":1.629734,"714978079870802":2.039667,"2501985819933790":7.188825,"308342441191607":9.7884,"688138148865252":6.998856,"1680208242311921":170.942061,"5123895267669322":6.60892,"1083671948865938":9.138506,"492363025786697":14.577617,"919842858702875":30.055088,"693509194981172":20.646626,"3145660139092010":11.648096,"399311065332465":72.13821,"3095594897370735":71.488316,"1158400764964546":0.029995,"304822341632403":389.98,"841296943402898":20.11,"1434838433599738":3.75}';
        // $rs = json_decode($c5Insight, true);
        // $db = '[{"nickname":"吴慧毓","id":8265,"name":"12.28 西语现言李6（吴慧毓）.mp4","owner_id":114,"hash_id":"478530530372875"},{"nickname":"吴慧毓","id":9116,"name":"1.14 欧美现言1改标题内容（吴慧毓）.mp4","owner_id":114,"hash_id":"1782506865274829"},{"nickname":"吴慧毓","id":10578,"name":"2.15 欧美现言陈1（吴慧毓）.mp4","owner_id":114,"hash_id":"486939213003837"},{"nickname":"吴慧毓","id":10997,"name":"2.28 欧美现言陈3（吴慧毓）.mp4","owner_id":114,"hash_id":"311445037635554"},{"nickname":"吴慧毓","id":8931,"name":"1.12 欧美现言4改内容（吴慧毓）.mp4","owner_id":114,"hash_id":"305943251492105"},{"nickname":"吴慧毓","id":10904,"name":"2.25 欧美现言高12.mp4","owner_id":114,"hash_id":"1680208242311921"},{"nickname":"吴慧毓","id":10499,"name":"2.14 欧美现言李5（吴慧毓）.mp4","owner_id":114,"hash_id":"2710798732397506"},{"nickname":"吴慧毓","id":10276,"name":"2.10 欧美现言陈3（吴慧毓）.mp4","owner_id":114,"hash_id":"484401389963978"},{"nickname":"吴慧毓","id":10630,"name":"2.16 欧美现言陈3（吴慧毓）.mp4","owner_id":114,"hash_id":"676981423322475"},{"nickname":"吴慧毓","id":8801,"name":"1.7 西语现言李1（吴慧毓）.mp4","owner_id":114,"hash_id":"671658947181913"},{"nickname":"吴慧毓","id":10590,"name":"2.15 欧美现言陈5（吴慧毓）.mp4","owner_id":114,"hash_id":"292395022993650"},{"nickname":"吴慧毓","id":9115,"name":"1.14 欧美现言4改标题内容（吴慧毓）.mp4","owner_id":114,"hash_id":"695875568457942"},{"nickname":"吴慧毓","id":10630,"name":"2.16 欧美现言陈3（吴慧毓）.mp4","owner_id":114,"hash_id":"497239455257732"},{"nickname":"吴慧毓","id":8580,"name":"1.4 西语现言李2（吴慧毓）.mp4","owner_id":114,"hash_id":"1127953994675689"},{"nickname":"吴慧毓","id":10905,"name":"2.25 欧美现言高2（吴慧毓）.mp4","owner_id":114,"hash_id":"1083671948865938"},{"nickname":"吴慧毓","id":10496,"name":"2.14 欧美现言李1（吴慧毓）.mp4","owner_id":114,"hash_id":"317534910398364"},{"nickname":"吴慧毓","id":8482,"name":"12.31 欧美现言1李（吴慧毓）.mp4","owner_id":114,"hash_id":"341761541085235"},{"nickname":"吴慧毓","id":10282,"name":"2.10 西语现言陈5（吴慧毓）.mp4","owner_id":114,"hash_id":"3053309881552806"},{"nickname":"吴慧毓","id":8800,"name":"1.7 西语现言李3（吴慧毓）.mp4","owner_id":114,"hash_id":"224539429884839"},{"nickname":"吴慧毓","id":10588,"name":"2.15 欧美现言陈4（吴慧毓）.mp4","owner_id":114,"hash_id":"3132391190339243"},{"nickname":"吴慧毓","id":9114,"name":"1.14 欧美现言2改标题内容（吴慧毓）.mp4","owner_id":114,"hash_id":"299802495533157"},{"nickname":"吴慧毓","id":10632,"name":"2.16 欧美现言陈1（吴慧毓）.mp4","owner_id":114,"hash_id":"477676443931245"},{"nickname":"吴慧毓","id":8341,"name":"12.29 欧美现言李2（吴慧毓）.mp4","owner_id":114,"hash_id":"322830633179108"},{"nickname":"吴慧毓","id":10907,"name":"2.25 欧美现言高1（吴慧毓）.mp4","owner_id":114,"hash_id":"306942041420095"},{"nickname":"吴慧毓","id":10501,"name":"2.14 欧美现言李6（吴慧毓）.mp4","owner_id":114,"hash_id":"685205569588266"},{"nickname":"吴慧毓","id":8484,"name":"12.31 欧美现言3李（吴慧毓）.mp4","owner_id":114,"hash_id":"1347762798987932"},{"nickname":"吴慧毓","id":10279,"name":"2.10 西语现言陈1（吴慧毓）.mp4","owner_id":114,"hash_id":"478859737164798"},{"nickname":"吴慧毓","id":8802,"name":"1.7 西语现言李2（吴慧毓）.mp4","owner_id":114,"hash_id":"458117859226771"},{"nickname":"吴慧毓","id":10591,"name":"2.15 欧美现言陈3（吴慧毓）.mp4","owner_id":114,"hash_id":"348176953687120"},{"nickname":"吴慧毓","id":10630,"name":"2.16 欧美现言陈3（吴慧毓）.mp4","owner_id":114,"hash_id":"687645312366722"},{"nickname":"吴慧毓","id":9111,"name":"1.14 欧美现言陈1（吴慧毓）.mp4","owner_id":114,"hash_id":"984319699108503"},{"nickname":"吴慧毓","id":8314,"name":"12.29 西语现言李1（吴慧毓）.mp4","owner_id":114,"hash_id":"256177843285726"},{"nickname":"吴慧毓","id":10906,"name":"2.25 欧美现言高8（吴慧毓）.mp4","owner_id":114,"hash_id":"3145660139092010"},{"nickname":"吴慧毓","id":10497,"name":"2.14 欧美现言李3（吴慧毓）.mp4","owner_id":114,"hash_id":"2123688844451286"},{"nickname":"吴慧毓","id":8483,"name":"12.31 欧美现言2李（吴慧毓）.mp4","owner_id":114,"hash_id":"1562133620828383"},{"nickname":"吴慧毓","id":10653,"name":"2.17 欧美现言陈2（吴慧毓）.mp4","owner_id":114,"hash_id":"966277611438906"},{"nickname":"吴慧毓","id":10994,"name":"2.28 欧美现言陈2（吴慧毓）.mp4","owner_id":114,"hash_id":"2753966611571096"},{"nickname":"吴慧毓","id":10589,"name":"2.15 欧美现言陈2（吴慧毓）.mp4","owner_id":114,"hash_id":"1245005946028386"},{"nickname":"吴慧毓","id":10901,"name":"2.25 欧美现言高9.mp4","owner_id":114,"hash_id":"3095594897370735"},{"nickname":"吴慧毓","id":10652,"name":"2.17 欧美现言陈3（吴慧毓）.mp4","owner_id":114,"hash_id":"645175270090670"},{"nickname":"吴慧毓","id":9110,"name":"1.14 欧美现言陈2（吴慧毓）.mp4","owner_id":114,"hash_id":"960348928238904"},{"nickname":"吴慧毓","id":10723,"name":"2.23 西语现言陈3（吴慧毓）.mp4","owner_id":114,"hash_id":"257647009881674"},{"nickname":"吴慧毓","id":8262,"name":"12.28 西语现言李2（吴慧毓）.mp4","owner_id":114,"hash_id":"664563431370895"},{"nickname":"吴慧毓","id":10908,"name":"2.25 欧美现言高7（吴慧毓）.mp4","owner_id":114,"hash_id":"5123895267669322"},{"nickname":"吴慧毓","id":9364,"name":"1.20 欧美现言陈1（吴慧毓）.mp4","owner_id":114,"hash_id":"1531770533876009"},{"nickname":"吴慧毓","id":10652,"name":"2.17 欧美现言陈3（吴慧毓）.mp4","owner_id":114,"hash_id":"550115306001912"},{"nickname":"吴慧毓","id":10995,"name":"2.28 欧美现言陈4（吴慧毓）.mp4","owner_id":114,"hash_id":"1073842513472432"},{"nickname":"吴慧毓","id":9029,"name":"1.13 欧美现言陈3（吴慧毓）.mp4","owner_id":114,"hash_id":"798690458198520"},{"nickname":"吴慧毓","id":10578,"name":"2.15 欧美现言陈1（吴慧毓）.mp4","owner_id":114,"hash_id":"1551735218516444"},{"nickname":"吴慧毓","id":10902,"name":"2.25 欧美现言高10.mp4","owner_id":114,"hash_id":"399311065332465"},{"nickname":"吴慧毓","id":10653,"name":"2.17 欧美现言陈2（吴慧毓）.mp4","owner_id":114,"hash_id":"624096925323848"},{"nickname":"吴慧毓","id":9117,"name":"1.14 欧美现言5改标题内容（吴慧毓）.mp4","owner_id":114,"hash_id":"394586589086151"},{"nickname":"吴慧毓","id":10724,"name":"2.23 西语现言陈2（吴慧毓）.mp4","owner_id":114,"hash_id":"1132054034215747"},{"nickname":"吴慧毓","id":8261,"name":"12.28 西语现言李3（吴慧毓）.mp4","owner_id":114,"hash_id":"323937169590387"},{"nickname":"吴慧毓","id":10910,"name":"2.25 欧美现言高13（吴慧毓）.mp4","owner_id":114,"hash_id":"340938197915028"},{"nickname":"吴慧毓","id":9247,"name":"1.18 欧美现言3（吴慧毓）.mp4","owner_id":114,"hash_id":"674653843893921"},{"nickname":"吴慧毓","id":10651,"name":"2.17 欧美现言陈4（吴慧毓）.mp4","owner_id":114,"hash_id":"1068783177313253"},{"nickname":"吴慧毓","id":10996,"name":"2.28 欧美现言陈1（吴慧毓）.mp4","owner_id":114,"hash_id":"250310240513818"},{"nickname":"吴慧毓","id":9067,"name":"1.13 欧美现言陈5改内容BGM标题（吴慧毓）.mp4","owner_id":114,"hash_id":"2382202318583857"},{"nickname":"吴慧毓","id":10903,"name":"2.25 欧美现言高11.mp4","owner_id":114,"hash_id":"4955055417921897"},{"nickname":"吴慧毓","id":10595,"name":"2.15 欧美现言李3（吴慧毓）.mp4","owner_id":114,"hash_id":"952531325654462"},{"nickname":"吴慧毓","id":6411,"name":"11.16 欧美现言2李（吴慧毓）.mp4","owner_id":114,"hash_id":"456093566161308"},{"nickname":"吴慧毓","id":10578,"name":"2.15 欧美现言陈1（吴慧毓）.mp4","owner_id":114,"hash_id":"280234050740264"},{"nickname":"吴慧毓","id":10725,"name":"2.23 西语现言陈1（吴慧毓）.mp4","owner_id":114,"hash_id":"480106710436251"},{"nickname":"吴敏","id":10875,"name":"0225欧美3.mp4","owner_id":127,"hash_id":"3092751117654975"},{"nickname":"吴敏","id":10702,"name":"0222欧美7.mp4","owner_id":127,"hash_id":"458999899291494"},{"nickname":"吴敏","id":10817,"name":"0224欧美5.mp4","owner_id":127,"hash_id":"3312729852348487"},{"nickname":"吴敏","id":10718,"name":"0223欧美7.mp4","owner_id":127,"hash_id":"731432671573830"},{"nickname":"吴敏","id":10876,"name":"0225欧美4.mp4","owner_id":127,"hash_id":"1019337265629505"},{"nickname":"吴敏","id":10701,"name":"0222欧美6.mp4","owner_id":127,"hash_id":"664917091600717"},{"nickname":"吴敏","id":10809,"name":"0224欧美2.mp4","owner_id":127,"hash_id":"529856655059258"},{"nickname":"吴敏","id":10826,"name":"0224欧美8.mp4","owner_id":127,"hash_id":"323041603202121"},{"nickname":"吴敏","id":10717,"name":"0223欧美6.mp4","owner_id":127,"hash_id":"957239988292808"},{"nickname":"吴敏","id":10878,"name":"0225欧美2.mp4","owner_id":127,"hash_id":"332209432177813"},{"nickname":"吴敏","id":10676,"name":"0222欧美4.mp4","owner_id":127,"hash_id":"770956977198301"},{"nickname":"吴敏","id":10817,"name":"0224欧美5.mp4","owner_id":127,"hash_id":"299159688896658"},{"nickname":"吴敏","id":10836,"name":"0224欧美9.mp4","owner_id":127,"hash_id":"5109535725769130"},{"nickname":"吴敏","id":10712,"name":"0223欧美1.mp4","owner_id":127,"hash_id":"1096823577527831"},{"nickname":"吴敏","id":10890,"name":"0225欧美10.mp4","owner_id":127,"hash_id":"472538071029191"},{"nickname":"吴敏","id":10675,"name":"0222欧美3.mp4","owner_id":127,"hash_id":"265517945729146"},{"nickname":"吴敏","id":10808,"name":"0224欧美1.mp4","owner_id":127,"hash_id":"1056730524884174"},{"nickname":"吴敏","id":10837,"name":"0224欧美10.mp4","owner_id":127,"hash_id":"488528526007625"},{"nickname":"吴敏","id":10677,"name":"0222欧美5.mp4","owner_id":127,"hash_id":"980298399530843"},{"nickname":"吴敏","id":10713,"name":"0223欧美2.mp4","owner_id":127,"hash_id":"627792374995523"},{"nickname":"吴敏","id":10674,"name":"0222欧美2.mp4","owner_id":127,"hash_id":"469126704817447"},{"nickname":"吴敏","id":10878,"name":"0225欧美2.mp4","owner_id":127,"hash_id":"4914099008655444"},{"nickname":"吴敏","id":10676,"name":"0222欧美4.mp4","owner_id":127,"hash_id":"494416398759549"},{"nickname":"吴敏","id":10715,"name":"0223欧美4.mp4","owner_id":127,"hash_id":"260231029614879"},{"nickname":"吴敏","id":10673,"name":"0222欧美1 (2).mp4","owner_id":127,"hash_id":"693392408755127"},{"nickname":"吴敏","id":10874,"name":"0225欧美1.mp4","owner_id":127,"hash_id":"282088190709072"},{"nickname":"吴敏","id":10675,"name":"0222欧美3.mp4","owner_id":127,"hash_id":"644972063421514"},{"nickname":"吴敏","id":10714,"name":"0223欧美3.mp4","owner_id":127,"hash_id":"4844691228955592"},{"nickname":"李旭尧","id":10613,"name":"djx-战神1-西语版4.mp4","owner_id":126,"hash_id":"464064908733208"},{"nickname":"李旭尧","id":10614,"name":"djx-战神1-西语版1.mp4","owner_id":126,"hash_id":"735614637343657"},{"nickname":"李旭尧","id":10615,"name":"djx-战神1-西语版2.mp4","owner_id":126,"hash_id":"962112864419472"},{"nickname":"李旭尧","id":10611,"name":"djx-战神1-西语版_1.mp4","owner_id":126,"hash_id":"926073338076002"},{"nickname":"李旭尧","id":10610,"name":"djx-战神1-西语版5.mp4","owner_id":126,"hash_id":"298815185581952"},{"nickname":"李旭尧","id":10612,"name":"djx-战神1-西语版3.mp4","owner_id":126,"hash_id":"727098594920715"},{"nickname":"李旭尧","id":8510,"name":"视频 (14).mp4","owner_id":126,"hash_id":"349181580061915"},{"nickname":"王琳依","id":9036,"name":"1.13英文王琳依3（音乐和标题）.mp4","owner_id":117,"hash_id":"252957516909086"},{"nickname":"高娇娇","id":10666,"name":"0218-17.mp4","owner_id":121,"hash_id":"496181715183029"},{"nickname":"高娇娇","id":10706,"name":"0218-14.mp4","owner_id":121,"hash_id":"526974358737705"},{"nickname":"高娇娇","id":10705,"name":"0218-15.mp4","owner_id":121,"hash_id":"2027877047380300"},{"nickname":"高娇娇","id":10704,"name":"0218-02.mp4","owner_id":121,"hash_id":"1040999279830936"},{"nickname":"高娇娇","id":10664,"name":"0218-16.mp4","owner_id":121,"hash_id":"1607600499590563"},{"nickname":"高娇娇","id":10665,"name":"0218-03.mp4","owner_id":121,"hash_id":"260245329597838"}]';
        // $dbRs = json_decode($db, true);
        // echo 'nickname,name,hash_id,spend' . PHP_EOL;
        // foreach ($dbRs as $row) {
        //
        //     $temp = [];
        //     $temp['nickname'] = $row['nickname'];
        //     $temp['name'] = $row['name'];
        //     $temp['hash_id'] = $row['hash_id'];
        //     $temp['spend'] = $rs[$row['hash_id']] ?? 0;
        //     echo implode(",", $temp) . PHP_EOL;
        //
        //
        // }


    }

}
